{
    "sourceFile": "views/site/checkout.ejs",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 1,
            "patches": [
                {
                    "date": 1766087697182,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766093786863,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,12 @@\n     </div>\r\n     <a href=\"/cart\" class=\"btn btn-outline-secondary\">← Back to Cart</a>\r\n   </div>\r\n \r\n-  <% const cartItems = (typeof items !== 'undefined' && Array.isArray(items)) ? items : []; %>\r\n+  <%\r\n+    const cartItems = (typeof items !== 'undefined' && Array.isArray(items)) ? items : [];\r\n+    const money = (n) => Number(n || 0).toFixed(2);\r\n+  %>\r\n \r\n   <% if (!cartItems || cartItems.length === 0) { %>\r\n     <div class=\"alert alert-light border\">Your cart is empty.</div>\r\n     <a href=\"/\" class=\"btn btn-primary\">Shop Now</a>\r\n@@ -16,24 +19,29 @@\n \r\n     <div class=\"card border-0 shadow-sm mb-3\">\r\n       <div class=\"card-body\">\r\n         <ul class=\"list-group list-group-flush\">\r\n-          <% cartItems.forEach(function(it){ %>\r\n+          <% cartItems.forEach(function(it){ \r\n+               const p = it.product;\r\n+               const name = p ? p.name : 'Unknown Product';\r\n+               const qty = Number(it.qty || 1);\r\n+               const lineTotal = Number(it.lineTotal || 0);\r\n+          %>\r\n             <li class=\"list-group-item d-flex justify-content-between align-items-center px-0\">\r\n               <div>\r\n-                <div class=\"fw-semibold\"><%= it.product.name %></div>\r\n-                <div class=\"text-muted small\">Qty: <%= it.qty %></div>\r\n+                <div class=\"fw-semibold\"><%= name %></div>\r\n+                <div class=\"text-muted small\">Qty: <%= qty %></div>\r\n               </div>\r\n-              <div class=\"fw-semibold\">$<%= Number(it.lineTotal || 0).toFixed(2) %></div>\r\n+              <div class=\"fw-semibold\">$<%= money(lineTotal) %></div>\r\n             </li>\r\n           <% }) %>\r\n         </ul>\r\n \r\n         <hr />\r\n \r\n         <div class=\"d-flex justify-content-between\">\r\n           <div class=\"fw-semibold\">Total</div>\r\n-          <div class=\"fw-bold\">$<%= Number(total || 0).toFixed(2) %></div>\r\n+          <div class=\"fw-bold\">$<%= money(total) %></div>\r\n         </div>\r\n \r\n         <form method=\"POST\" action=\"/checkout\" class=\"mt-3\">\r\n           <button class=\"btn btn-success w-100\">Place Order</button>\r\n"
                }
            ],
            "date": 1766087697181,
            "name": "Commit-0",
            "content": "<div class=\"container py-4\">\r\n  <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n    <div>\r\n      <h1 class=\"h3 fw-bold mb-1\">Checkout</h1>\r\n      <p class=\"text-muted mb-0\">Confirm your order.</p>\r\n    </div>\r\n    <a href=\"/cart\" class=\"btn btn-outline-secondary\">← Back to Cart</a>\r\n  </div>\r\n\r\n  <% const cartItems = (typeof items !== 'undefined' && Array.isArray(items)) ? items : []; %>\r\n\r\n  <% if (!cartItems || cartItems.length === 0) { %>\r\n    <div class=\"alert alert-light border\">Your cart is empty.</div>\r\n    <a href=\"/\" class=\"btn btn-primary\">Shop Now</a>\r\n  <% } else { %>\r\n\r\n    <div class=\"card border-0 shadow-sm mb-3\">\r\n      <div class=\"card-body\">\r\n        <ul class=\"list-group list-group-flush\">\r\n          <% cartItems.forEach(function(it){ %>\r\n            <li class=\"list-group-item d-flex justify-content-between align-items-center px-0\">\r\n              <div>\r\n                <div class=\"fw-semibold\"><%= it.product.name %></div>\r\n                <div class=\"text-muted small\">Qty: <%= it.qty %></div>\r\n              </div>\r\n              <div class=\"fw-semibold\">$<%= Number(it.lineTotal || 0).toFixed(2) %></div>\r\n            </li>\r\n          <% }) %>\r\n        </ul>\r\n\r\n        <hr />\r\n\r\n        <div class=\"d-flex justify-content-between\">\r\n          <div class=\"fw-semibold\">Total</div>\r\n          <div class=\"fw-bold\">$<%= Number(total || 0).toFixed(2) %></div>\r\n        </div>\r\n\r\n        <form method=\"POST\" action=\"/checkout\" class=\"mt-3\">\r\n          <button class=\"btn btn-success w-100\">Place Order</button>\r\n        </form>\r\n\r\n        <div class=\"text-muted small mt-2 text-center\">\r\n          (Payment integration can be added next.)\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n  <% } %>\r\n</div>\r\n"
        }
    ]
}