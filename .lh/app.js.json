{
    "sourceFile": "app.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 2,
            "patches": [
                {
                    "date": 1765466191755,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1766079976021,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,8 +54,9 @@\n app.use('/api/auth', require('./routes/api/auth'));\r\n app.use('/', sessionAuth, indexRouter);\r\n app.use('/my-account', sessionAuth, checkSessionAuth, protectedRouter);\r\n app.use('/', sessionAuth, require('./routes/shop'));\r\n+app.use('/', sessionAuth, require('./routes/product-view')); // newly added\r\n app.get('/admin', async (req, res) => {\r\n   res.sendFile(path.join(__dirname, 'admin', 'build', 'index.html'));\r\n });\r\n app.get('/admin/*', async (req, res) => {\r\n"
                },
                {
                    "date": 1766080138396,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,83 @@\n+var createError = require('http-errors');\r\n+var express = require('express');\r\n+var path = require('path');\r\n+var cookieParser = require('cookie-parser');\r\n+var logger = require('morgan');\r\n+var expressLayouts = require('express-ejs-layouts');\r\n+var indexRouter = require('./routes/index');\r\n+var protectedRouter = require('./routes/protected');\r\n+var sessionAuth = require('./middlewares/sessionAuth');\r\n+var superAdminMiddleware = require('./middlewares/super-admin');\r\n+var checkSessionAuth = require('./middlewares/checkSessionAuth');\r\n+var apiauth = require('./middlewares/apiauth');\r\n+var session = require('express-session');\r\n+var app = express();\r\n+\r\n+var bodyParser = require('body-parser');\r\n+\r\n+app.use(bodyParser.json());\r\n+// for parsing application/xwww-\r\n+app.use(bodyParser.urlencoded({ extended: true }));\r\n+var config = require('config');\r\n+app.use(\r\n+  session({\r\n+    secret: config.get('sessionSecret'),\r\n+    //increase cookie maxage\r\n+    cookie: { maxAge: 360000000 },\r\n+    resave: true,\r\n+    saveUninitialized: true,\r\n+  })\r\n+);\r\n+// const { startCronJobs } = require(\"./croneJobs/index\");\r\n+// view engine setup\r\n+app.set('views', path.join(__dirname, 'views'));\r\n+app.set('view engine', 'ejs');\r\n+app.use(expressLayouts);\r\n+app.use(logger('dev'));\r\n+app.use(express.json());\r\n+app.use(express.urlencoded({ extended: false }));\r\n+app.use(cookieParser());\r\n+app.use(express.static(path.join(__dirname, 'public')));\r\n+app.use(\r\n+  '/super-admin',\r\n+  superAdminMiddleware,\r\n+  require('./routes/super-admin/dashbosrd')\r\n+);\r\n+app.use(\r\n+  '/super-admin',\r\n+  superAdminMiddleware,\r\n+  require('./routes/super-admin/products')\r\n+);\r\n+app.use('/api/public/products', require('./routes/api/public/products'));\r\n+app.use('/api/categories', require('./routes/api/catagories'));\r\n+app.use('/api/products', apiauth, require('./routes/api/products'));\r\n+app.use('/api/auth', require('./routes/api/auth'));\r\n+app.use('/', sessionAuth, indexRouter);\r\n+app.use('/my-account', sessionAuth, checkSessionAuth, protectedRouter);\r\n+app.use('/', sessionAuth, require('./routes/shop'));\r\n+app.use('/', sessionAuth, require('./routes/api/products')); // newly added\r\n+app.get('/admin', async (req, res) => {\r\n+  res.sendFile(path.join(__dirname, 'admin', 'build', 'index.html'));\r\n+});\r\n+app.get('/admin/*', async (req, res) => {\r\n+  res.sendFile(path.join(__dirname, 'admin', 'build', 'index.html'));\r\n+});\r\n+app.use(express.static(path.join(__dirname, 'admin', 'build')));\r\n+\r\n+// catch 404 and forward to error handler\r\n+app.use(function (req, res, next) {\r\n+  next(createError(404));\r\n+});\r\n+\r\n+// error handler\r\n+app.use(function (err, req, res, next) {\r\n+  // set locals, only providing error in development\r\n+  res.locals.message = err.message;\r\n+  res.locals.error = req.app.get('env') === 'development' ? err : {};\r\n+\r\n+  // render the error page\r\n+  res.status(err.status || 500);\r\n+  res.render('error');\r\n+});\r\n+// startCronJobs();\r\n+module.exports = app;\r\n"
                }
            ],
            "date": 1765466191755,
            "name": "Commit-0",
            "content": "var createError = require(\"http-errors\");\r\nvar express = require(\"express\");\r\nvar path = require(\"path\");\r\nvar cookieParser = require(\"cookie-parser\");\r\nvar logger = require(\"morgan\");\r\nvar expressLayouts = require(\"express-ejs-layouts\");\r\nvar indexRouter = require(\"./routes/index\");\r\nvar protectedRouter = require(\"./routes/protected\");\r\nvar sessionAuth = require(\"./middlewares/sessionAuth\");\r\nvar superAdminMiddleware = require(\"./middlewares/super-admin\");\r\nvar checkSessionAuth = require(\"./middlewares/checkSessionAuth\");\r\nvar apiauth = require(\"./middlewares/apiauth\");\r\nvar session = require(\"express-session\");\r\nvar app = express();\r\n\r\nvar bodyParser = require(\"body-parser\");\r\n\r\napp.use(bodyParser.json());\r\n// for parsing application/xwww-\r\napp.use(bodyParser.urlencoded({ extended: true }));\r\nvar config = require(\"config\");\r\napp.use(\r\n  session({\r\n    secret: config.get(\"sessionSecret\"),\r\n    //increase cookie maxage\r\n    cookie: { maxAge: 360000000 },\r\n    resave: true,\r\n    saveUninitialized: true,\r\n  })\r\n);\r\n// const { startCronJobs } = require(\"./croneJobs/index\");\r\n// view engine setup\r\napp.set(\"views\", path.join(__dirname, \"views\"));\r\napp.set(\"view engine\", \"ejs\");\r\napp.use(expressLayouts);\r\napp.use(logger(\"dev\"));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\napp.use(cookieParser());\r\napp.use(express.static(path.join(__dirname, \"public\")));\r\napp.use(\r\n  \"/super-admin\",\r\n  superAdminMiddleware,\r\n  require(\"./routes/super-admin/dashbosrd\")\r\n);\r\napp.use(\r\n  \"/super-admin\",\r\n  superAdminMiddleware,\r\n  require(\"./routes/super-admin/products\")\r\n);\r\napp.use(\"/api/public/products\", require(\"./routes/api/public/products\"));\r\napp.use(\"/api/categories\", require(\"./routes/api/catagories\"));\r\napp.use(\"/api/products\", apiauth, require(\"./routes/api/products\"));\r\napp.use(\"/api/auth\", require(\"./routes/api/auth\"));\r\napp.use(\"/\", sessionAuth, indexRouter);\r\napp.use(\"/my-account\", sessionAuth, checkSessionAuth, protectedRouter);\r\napp.use(\"/\", sessionAuth, require(\"./routes/shop\"));\r\napp.get(\"/admin\", async (req, res) => {\r\n  res.sendFile(path.join(__dirname, \"admin\", \"build\", \"index.html\"));\r\n});\r\napp.get(\"/admin/*\", async (req, res) => {\r\n  res.sendFile(path.join(__dirname, \"admin\", \"build\", \"index.html\"));\r\n});\r\napp.use(express.static(path.join(__dirname, \"admin\", \"build\")));\r\n\r\n// catch 404 and forward to error handler\r\napp.use(function (req, res, next) {\r\n  next(createError(404));\r\n});\r\n\r\n// error handler\r\napp.use(function (err, req, res, next) {\r\n  // set locals, only providing error in development\r\n  res.locals.message = err.message;\r\n  res.locals.error = req.app.get(\"env\") === \"development\" ? err : {};\r\n\r\n  // render the error page\r\n  res.status(err.status || 500);\r\n  res.render(\"error\");\r\n});\r\n// startCronJobs();\r\nmodule.exports = app;\r\n"
        }
    ]
}